{"version":3,"file":"index.umd.min.js","sources":["../src/CybObj.ts"],"sourcesContent":["import type { descriptorT, keyT, CybObjT, primalObjT } from './Types';\n\nexport default class CybObj implements CybObjT {\n  /**\n   * @type boolean\n   */\n  protected isExtensible = true;\n  [key: keyT]: unknown;\n\n  /**\n   * Assimilate given object to be listenable\n   * @param {primalObjT} primalObj\n   * @param {boolean} isExtensible\n   */\n  constructor(primalObj: primalObjT, isExtensible = false) {\n    Object.keys(primalObj).forEach((key) => {\n      const descriptor = primalObj[key] as descriptorT;\n      this.add(key, descriptor);\n    });\n    this.isExtensible = isExtensible;\n  }\n\n  /**\n   * Add new listenable property to $self\n   * @param {keyT} key\n   * @param {descriptorT} descriptorT\n   */\n  add(key: keyT, descriptorT: descriptorT) {\n    if (!this.isExtensible) {\n      throw 'Adding new property to a unexpendable CybObj.';\n    }\n    this.assimilateProp(key, descriptorT);\n  }\n\n  /**\n   * Couple given listeners with acessor/mutator and assign to the given property ($key)\n   * @param {keyT} key\n   * @param {descriptorT} descriptor\n   */\n  protected assimilateProp(key: keyT, descriptor: descriptorT): void {\n    const privateKey: keyT = `#${key}`;\n    Object.defineProperty(this, key, {\n      enumerable: true,\n      configurable: false,\n      get() {\n        const value = this[privateKey];\n        descriptor.onAccess?.(key, value);\n        return value;\n      },\n      set(newVal) {\n        const oldVal = this[privateKey];\n        this[privateKey] = newVal;\n        descriptor.onChange?.(key, oldVal, newVal);\n      },\n    });\n    this[key] = descriptor.value;\n  }\n}\n"],"names":["CybObj","primalObj","isExtensible","_this","this","Object","keys","forEach","key","descriptor","add","prototype","descriptorT","assimilateProp","privateKey","concat","defineProperty","enumerable","configurable","get","value","_a","onAccess","call","set","newVal","oldVal","onChange"],"mappings":";;;;;8OAEA,IAAAA,EAAA,WAYE,SAAYA,EAAAC,EAAuBC,QAAA,IAAAA,IAAAA,GAAoB,GAAvD,IAMCC,EAAAC,KAdSA,KAAYF,cAAG,EASvBG,OAAOC,KAAKL,GAAWM,SAAQ,SAACC,GAC9B,IAAMC,EAAaR,EAAUO,GAC7BL,EAAKO,IAAIF,EAAKC,EAChB,IACAL,KAAKF,aAAeA,CACrB,CAqCH,OA9BEF,EAAAW,UAAAD,IAAA,SAAIF,EAAWI,GACb,IAAKR,KAAKF,aACR,KAAM,gDAERE,KAAKS,eAAeL,EAAKI,IAQjBZ,EAAAW,UAAAE,eAAV,SAAyBL,EAAWC,GAClC,IAAMK,EAAmB,IAAIC,OAAAP,GAC7BH,OAAOW,eAAeZ,KAAMI,EAAK,CAC/BS,YAAY,EACZC,cAAc,EACdC,IAAG,iBACKC,EAAQhB,KAAKU,GAEnB,OADmB,QAAnBO,EAAAZ,EAAWa,gBAAQ,IAAAD,GAAAA,EAAAE,KAAAd,EAAGD,EAAKY,GACpBA,CACR,EACDI,aAAIC,SACIC,EAAStB,KAAKU,GACpBV,KAAKU,GAAcW,EACG,QAAtBJ,EAAAZ,EAAWkB,gBAAW,IAAAN,GAAAA,EAAAE,KAAAd,EAAAD,EAAKkB,EAAQD,EACpC,IAEHrB,KAAKI,GAAOC,EAAWW,OAE1BpB,CAAD"}